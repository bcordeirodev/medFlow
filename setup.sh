#!/bin/bash

echo "üöÄ Configurando o MedFlow..."

# Verificar se o Node.js est√° instalado
if ! command -v node &> /dev/null; then
    echo "‚ùå Node.js n√£o est√° instalado. Por favor, instale o Node.js 18+ primeiro."
    exit 1
fi

# Verificar se o PostgreSQL est√° instalado
if ! command -v psql &> /dev/null; then
    echo "‚ùå PostgreSQL n√£o est√° instalado. Por favor, instale o PostgreSQL primeiro."
    exit 1
fi

echo "‚úÖ Node.js e PostgreSQL encontrados"

# Criar arquivo .env para o backend
echo "üìù Criando arquivo .env para o backend..."
cat > backend/.env << EOF
# Database
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=password
DB_NAME=medflow

# JWT
JWT_SECRET=medflow-super-secret-key-change-in-production

# Environment
NODE_ENV=development
EOF

echo "‚úÖ Arquivo .env criado"

# Instalar depend√™ncias do backend
echo "üì¶ Instalando depend√™ncias do backend..."
cd backend
npm install

# Instalar depend√™ncias do frontend
echo "üì¶ Instalando depend√™ncias do frontend..."
cd ../frontend
npm install

echo "‚úÖ Depend√™ncias instaladas"

# Criar banco de dados
echo "üóÑÔ∏è Criando banco de dados..."
createdb medflow 2>/dev/null || echo "Banco de dados j√° existe"

echo "‚úÖ Banco de dados criado"

echo ""
echo "üéâ Setup conclu√≠do!"
echo ""
echo "üìã Tecnologias utilizadas:"
echo "   ‚Ä¢ Backend: NestJS + TypeORM + PostgreSQL"
echo "   ‚Ä¢ Frontend: Next.js 19 + Material-UI + TypeScript"
echo "   ‚Ä¢ Autentica√ß√£o: JWT"
echo ""
echo "üöÄ Para executar o projeto:"
echo ""
echo "1. Backend:"
echo "   cd backend"
echo "   npm run start:dev"
echo ""
echo "2. Frontend (em outro terminal):"
echo "   cd frontend"
echo "   npm run dev"
echo ""
echo "3. Acesse: http://localhost:3000"
echo ""
echo "üé® Interface:"
echo "   ‚Ä¢ Material-UI (MUI) para componentes modernos"
echo "   ‚Ä¢ Design responsivo e acess√≠vel"
echo "   ‚Ä¢ Tema customiz√°vel"
echo ""
echo "‚ö†Ô∏è  IMPORTANTE: Altere a senha do PostgreSQL no arquivo backend/.env"
echo "‚ö†Ô∏è  IMPORTANTE: Altere o JWT_SECRET no arquivo backend/.env" 